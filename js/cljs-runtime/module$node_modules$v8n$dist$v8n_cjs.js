import "./cljs_env.js";
shadow$provide.module$node_modules$v8n$dist$v8n_cjs=function(global,require,module,exports){function pickFn(fn,variant){void 0===variant&&(variant="simple");return"object"===typeof fn?fn[variant]:fn}function testAux(modifiers,fn,rule){if(modifiers.length){var modifier=modifiers.shift();modifiers=testAux(modifiers,fn,rule);return modifier.perform(modifiers,rule)}return pickFn(fn)}function testAsyncAux(modifiers,fn,rule){if(modifiers.length){var modifier=modifiers.shift();modifiers=testAsyncAux(modifiers,
fn,rule);return modifier.performAsync(modifiers,rule)}return function(value){return Promise.resolve(pickFn(fn,"async")(value))}}function executeAsyncRules(value,rules,resolve,reject){if(rules.length){var rule=rules.shift();rule._testAsync(value).then(function(){executeAsyncRules(value,rules,resolve,reject)},function(cause){reject(new ValidationError(rule,value,cause))})}else resolve(value)}function v8n(){return"undefined"!==typeof Proxy?proxyContext(new Context):proxylessContext(new Context)}function proxyContext(context){return new Proxy(context,
{get:function(obj,prop){if(prop in obj)return obj[prop];obj=proxyContext(context._clone());if(prop in availableModifiers)return obj._applyModifier(availableModifiers[prop],prop);if(prop in customRules)return obj._applyRule(customRules[prop],prop);if(prop in availableRules)return obj._applyRule(availableRules[prop],prop)}})}function proxylessContext(context){var addRuleSet=function(ruleSet,targetContext){Object.keys(ruleSet).forEach(function(prop){targetContext[prop]=function(){for(var args=[],len=
arguments.length;len--;)args[len]=arguments[len];return proxylessContext(targetContext._clone())._applyRule(ruleSet[prop],prop).apply(void 0,args)}});return targetContext};context=addRuleSet(availableRules,context);var contextWithAllRules=addRuleSet(customRules,context);Object.keys(availableModifiers).forEach(function(prop){Object.defineProperty(contextWithAllRules,prop,{get:function(){return proxylessContext(contextWithAllRules._clone())._applyModifier(availableModifiers[prop],prop)}})});return contextWithAllRules}
function isSchemaRule(rule){return rule&&"schema"===rule.name&&0<rule.args.length&&"object"===typeof rule.args[0]}function split(value){return"string"===typeof value?value.split(""):value}function testType(expected){return function(value){return Array.isArray(value)&&"array"===expected||null===value&&"null"===expected||typeof value===expected}}function isIntegerPolyfill(value){return"number"===typeof value&&isFinite(value)&&Math.floor(value)===value}function testSchema(schema){return{simple:function(value){var causes=
[];Object.keys(schema).forEach(function(key){var nestedValidation=schema[key];try{nestedValidation.check((value||{})[key])}catch(ex){ex.target=key,causes.push(ex)}});if(0<causes.length)throw causes;return!0},async:function(value){var causes=[],nested=Object.keys(schema).map(function(key){return schema[key].testAsync((value||{})[key]).catch(function(ex){ex.target=key;causes.push(ex)})});return Promise.all(nested).then(function(){if(0<causes.length)throw causes;return!0})}}}var Rule=function(name,fn,
args,modifiers){this.name=name;this.fn=fn;this.args=args;this.modifiers=modifiers};Rule.prototype._test=function(value){var fn=this.fn;try{testAux(this.modifiers.slice(),fn,this)(value)}catch(ex){fn=function(){return!1}}try{return testAux(this.modifiers.slice(),fn,this)(value)}catch(ex$1){return!1}};Rule.prototype._check=function(value){try{testAux(this.modifiers.slice(),this.fn,this)(value)}catch(ex){if(testAux(this.modifiers.slice(),function(it){return it},this)(!1))return}if(!testAux(this.modifiers.slice(),
this.fn,this)(value))throw null;};Rule.prototype._testAsync=function(value){var this$1=this;return new Promise(function(resolve,reject){testAsyncAux(this$1.modifiers.slice(),this$1.fn,this$1)(value).then(function(valid){valid?resolve(value):reject(null)}).catch(function(ex){return reject(ex)})})};var Modifier=function(name,perform,performAsync){this.name=name;this.perform=perform;this.performAsync=performAsync},ValidationError=function(Error){function ValidationError(rule,value,cause,target){for(var remaining=
[],len=arguments.length-4;0<len--;)remaining[len]=arguments[len+4];Error.call(this,remaining);Error.captureStackTrace&&Error.captureStackTrace(this,ValidationError);this.rule=rule;this.value=value;this.cause=cause;this.target=target}Error&&(ValidationError.__proto__=Error);ValidationError.prototype=Object.create(Error&&Error.prototype);return ValidationError.prototype.constructor=ValidationError}(Error),Context=function(chain,nextRuleModifiers){void 0===chain&&(chain=[]);void 0===nextRuleModifiers&&
(nextRuleModifiers=[]);this.chain=chain;this.nextRuleModifiers=nextRuleModifiers};Context.prototype._applyRule=function(ruleFn,name){var this$1=this;return function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];this$1.chain.push(new Rule(name,ruleFn.apply(this$1,args),args,this$1.nextRuleModifiers));this$1.nextRuleModifiers=[];return this$1}};Context.prototype._applyModifier=function(modifier,name){this.nextRuleModifiers.push(new Modifier(name,modifier.simple,modifier.async));
return this};Context.prototype._clone=function(){return new Context(this.chain.slice(),this.nextRuleModifiers.slice())};Context.prototype.test=function(value){return this.chain.every(function(rule){return rule._test(value)})};Context.prototype.testAll=function(value){var err=[];this.chain.forEach(function(rule){try{rule._check(value)}catch(ex){err.push(new ValidationError(rule,value,ex))}});return err};Context.prototype.check=function(value){this.chain.forEach(function(rule){try{rule._check(value)}catch(ex){throw new ValidationError(rule,
value,ex);}})};Context.prototype.testAsync=function(value){var this$1=this;return new Promise(function(resolve,reject){executeAsyncRules(value,this$1.chain.slice(),resolve,reject)})};var consideredEmpty=function(value,considerTrimmedEmptyString){return considerTrimmedEmptyString&&"string"===typeof value&&0===value.trim().length?!0:void 0===value||null===value},customRules={};v8n.extend=function(newRules){Object.assign(customRules,newRules)};v8n.clearCustomRules=function(){customRules={}};var availableModifiers=
{not:{simple:function(fn){return function(value){return!fn(value)}},async:function(fn){return function(value){return Promise.resolve(fn(value)).then(function(result){return!result}).catch(function(){return!0})}}},some:{simple:function(fn){return function(value){return split(value).some(function(item){try{return fn(item)}catch(ex){return!1}})}},async:function(fn){return function(value){return Promise.all(split(value).map(function(item){try{return fn(item).catch(function(){return!1})}catch(ex){return!1}})).then(function(result){return result.some(Boolean)})}}},
every:{simple:function(fn){return function(value){return!1!==value&&split(value).every(fn)}},async:function(fn){return function(value){return Promise.all(split(value).map(fn)).then(function(result){return result.every(Boolean)})}}},strict:{simple:function(fn,rule){return function(value){return isSchemaRule(rule)&&value&&"object"===typeof value?Object.keys(rule.args[0]).length===Object.keys(value).length&&fn(value):fn(value)}},async:function(fn,rule){return function(value){return Promise.resolve(fn(value)).then(function(result){return isSchemaRule(rule)&&
value&&"object"===typeof value?Object.keys(rule.args[0]).length===Object.keys(value).length&&result:result}).catch(function(){return!1})}}}},availableRules={equal:function(expected){return function(value){return value==expected}},exact:function(expected){return function(value){return value===expected}},number:function(allowInfinite){void 0===allowInfinite&&(allowInfinite=!0);return function(value){return"number"===typeof value&&(allowInfinite||isFinite(value))}},integer:function(){return function(value){return(Number.isInteger||
isIntegerPolyfill)(value)}},numeric:function(){return function(value){return!isNaN(parseFloat(value))&&isFinite(value)}},string:function(){return testType("string")},boolean:function(){return testType("boolean")},undefined:function(){return testType("undefined")},null:function(){return testType("null")},array:function(){return testType("array")},object:function(){return testType("object")},instanceOf:function(instance){return function(value){return value instanceof instance}},pattern:function(expected){return function(value){return expected.test(value)}},
lowercase:function(){return function(value){return"boolean"===typeof value||value===value.toLowerCase()&&""!==value.trim()}},uppercase:function(){return function(value){return value===value.toUpperCase()&&""!==value.trim()}},vowel:function(){return function(value){return/^[aeiou]+$/i.test(value)}},consonant:function(){return function(value){return/^(?=[^aeiou])([a-z]+)$/i.test(value)}},first:function(expected){return function(value){return value[0]==expected}},last:function(expected){return function(value){return value[value.length-
1]==expected}},empty:function(){return function(value){return 0===value.length}},length:function(min,max){return function(value){return value.length>=min&&value.length<=(max||min)}},minLength:function(min){return function(value){return value.length>=min}},maxLength:function(max){return function(value){return value.length<=max}},negative:function(){return function(value){return 0>value}},positive:function(){return function(value){return 0<=value}},between:function(a,b){return function(value){return value>=
a&&value<=b}},range:function(a,b){return function(value){return value>=a&&value<=b}},lessThan:function(n){return function(value){return value<n}},lessThanOrEqual:function(n){return function(value){return value<=n}},greaterThan:function(n){return function(value){return value>n}},greaterThanOrEqual:function(n){return function(value){return value>=n}},even:function(){return function(value){return 0===value%2}},odd:function(){return function(value){return 0!==value%2}},includes:function(expected){return function(value){return~value.indexOf(expected)}},
schema:function(schema){return testSchema(schema)},passesAnyOf:function(){for(var validations=[],len=arguments.length;len--;)validations[len]=arguments[len];return function(value){return validations.some(function(validation){return validation.test(value)})}},optional:function(validation,considerTrimmedEmptyString){void 0===considerTrimmedEmptyString&&(considerTrimmedEmptyString=!1);return{simple:function(value){return consideredEmpty(value,considerTrimmedEmptyString)||void 0===validation.check(value)},
async:function(value){return consideredEmpty(value,considerTrimmedEmptyString)||validation.testAsync(value)}}}};module.exports=v8n}
//# sourceMappingURL=module$node_modules$v8n$dist$v8n_cjs.js.map
